{{ define "main" }}
<div class="bg-white min-h-screen">
  <!-- Hero Section -->
  <div class="max-w-4xl mx-auto px-6 pt-2 pb-2 text-center">
    <div class="mb-4">
      <h1 class="text-6xl font-light mb-4">
        <span class="text-blue-600">AUDITO</span><span class="text-gray-600">MATIC</span>
      </h1>
      <div class="w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-lg flex items-center justify-center">
        <div class="text-3xl">ðŸ”¬</div>
      </div>
    </div>
    
    <h2 class="text-2xl text-gray-600 font-light mb-4 uppercase tracking-wide">
      SYSTEMATIC LLM EVALUATION
    </h2>
    
    <div class="max-w-3xl mx-auto mb-4">
      <p class="text-lg text-gray-700 mb-4 leading-relaxed">
        Auditomatic is a no-code, local-first, browser-based tool for testing Large Language Models. 
        Create prompt templates with variables, run experiments across multiple models, and analyze results with pivot tables.
      </p>
      <p class="text-lg text-gray-700 mb-4 leading-relaxed">
        Auditomatic is designed for bias testing, capability evaluation, and prompt engineering research.
        Run your LLM experiments in the app or export to Python scripts for 100% reproducibility.
      </p>
    </div>
  </div>

  <!-- Demo Section -->
  <div class="max-w-6xl mx-auto px-6 pt-8 pb-12">
    <div class="flex gap-8">
      <!-- Left Column: Final Implementation -->
      <div class="flex-1">
        
        <!-- FINAL IMPLEMENTATION: CSS ::before/::after pseudo-elements -->
        <h3 class="text-lg font-medium text-gray-800 mb-3 text-center">Design templates with variable placeholders to test LLMs</h3>
        <div class="bg-gray-50 border border-gray-300 rounded p-4 font-mono text-xs">
          <style>
            .arrow-1 .box1 {
              position: relative;
            }
            .arrow-1 .box1::after {
              content: "â†³";
              position: absolute;
              left: 32px;
              bottom: -33px;
              color: #000;
              font-size: 32px;
              z-index: 10;
            }
            .arrow-1 .box2 {
              position: relative;
            }
            .arrow-1 .box2::after {
              content: "â†²";
              position: absolute;
              right: 32px;
              bottom: -33px;
              color: #000;
              font-size: 32px;
              z-index: 10;
            }
          </style>
          
          <!-- Instructions -->
          <div class="text-green-700 mb-1 font-bold"># System Instructions</div>
          <div class="text-gray-700 text-xs mb-3">You are a hiring manager evaluating resumes for a data science internship. Rate each candidate from 1.0-10.0. Do not give an explanation, just a score.</div>
          
          <div class="arrow-1">
            <!-- Template -->
            <div class="text-green-700 mb-1 font-bold"># Resume Excerpt</div>
            <div class="box1 bg-white border border-gray-300 p-2 rounded text-xs">
              <div class="text-gray-800">Name: <span class="bg-yellow-300 text-black px-1 rounded font-bold border border-yellow-500" id="prompt-name">{{ `{` }}{{ `{` }}NAME{{ `}` }}{{ `}` }}</span></div>
              <div class="text-gray-600 mt-1">Education: Computer Science, Stanford University</div>
              <div class="text-gray-600">GPA: 3.9/4.0 â€¢ Relevant Coursework: ML, Statistics</div>
              <div class="text-gray-600">Projects: Predictive model for student success</div>
              <div class="text-gray-600">Skills: Python, R, SQL, Pandas, Scikit-learn</div>
            </div>
            
            <!-- Black Box Processing (indented) -->
            <div class="box2 ml-16 bg-gray-800 border border-gray-500 p-2 rounded">
              <div class="flex items-center justify-between">
                <div class="text-blue-400 font-bold" id="model-name">ChutGPT-4.1-nano</div>
                <div class="text-gray-600">ðŸ”’ BLACK BOX</div>
              </div>
              <div class="text-gray-500 text-xs mt-1" id="black-box-status">Navigating multi-head attention mechanisms...</div>
            </div>
            
            <!-- Score Output (indented right) -->
            <div class="mr-16 bg-orange-50 border border-orange-400 p-2 rounded">
              <div class="text-orange-700 font-bold text-center">
                Score: <span class="text-black text-lg" id="result-score">8.7</span>/10
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Bias Pattern Heatmap -->
      <div class="flex-1">
        <h3 class="text-lg font-medium text-gray-800 mb-3 text-center">Collect and analyze results from LLM APIs in real time</h3>
        <div class="bg-gray-50 border border-gray-300 rounded p-2">
          <table class="w-full text-xs">
            <thead>
              <tr>
                <th class="border border-gray-300 p-1 bg-gray-100 text-xs"></th>
                <th class="border border-gray-300 p-1 bg-gray-100 text-xs">ChutGPT-4.1-nano</th>
                <th class="border border-gray-300 p-1 bg-gray-100 text-xs">Camel-3.1-405B</th>
                <th class="border border-gray-300 p-1 bg-gray-100 text-xs">Deepfind-R1</th>
              </tr>
            </thead>
            <tbody id="heatmap-body">
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Chad Andersen</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="chad-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="chad-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="chad-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Lisa Andersen</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="lisa-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="lisa-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="lisa-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Tyrone Jefferson</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="tyrone-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="tyrone-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="tyrone-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Latonya Jefferson</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="latonya-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="latonya-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="latonya-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Mohammad Hussein</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="mohammad-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="mohammad-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="mohammad-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Fatima Hussein</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="fatima-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="fatima-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="fatima-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">JosÃ© HernÃ¡ndez</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="jose-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="jose-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="jose-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Maria HernÃ¡ndez</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="maria-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="maria-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="maria-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Qingmei Chen</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="qingmei-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="qingmei-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="qingmei-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Feng Chen</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="feng-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="feng-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="feng-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Samir Singh</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="samir-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="samir-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="samir-deepfind">â€”</td>
              </tr>
              <tr>
                <td class="border border-gray-300 p-1 font-bold text-xs">Priyanka Singh</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="priyanka-chutgpt">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="priyanka-goat">â€”</td>
                <td class="border border-gray-300 p-1 text-center text-xs" id="priyanka-deepfind">â€”</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  

  <script src="/js/bias-data.js"></script>
  <script>
    let currentIndex = 0;
    let statusIndex = 0;
    
    const blackBoxStatuses = [
      "Navigating multi-head attention mechanisms...",
      "Computing positional embeddings...",
      "Traversing transformer layers...",
      "Retrieving historical biases from training corpus...",
      "Calculating softmax probability distributions...",
      "Reticulating splines...",
      "Normalizing latent space representations...",
      "Inheriting demographic correlations...",
      "Optimizing cross-entropy loss functions...",
      "Amplifying majority class patterns...",
      "Backpropagating through prejudice...",
      "Quantizing socioeconomic assumptions...",
      "Disambiguating polysemous tokens...",
      "Reproducing annotation worker biases...",
      "Adjusting temperature parameters...",
      "Encoding implicit associations...",
      "Maximizing log-likelihood estimations...",
      "Correlating protected attributes...",
      "Applying dropout to minority representations...",
      "Converging on hegemonic optima...",
      "Overfitting to WEIRD demographics...",
      "Perpetuating historical inequities...",
      "Minimizing representational harm (unsuccessfully)...",
      "Embedding systemic disparities...",
      "Laundering human prejudice through math..."
    ];
    
    function rotateBlackBoxStatus() {
      const statusElement = document.getElementById('black-box-status');
      if (statusElement) {
        statusElement.textContent = blackBoxStatuses[statusIndex];
        statusIndex = (statusIndex + 1) % blackBoxStatuses.length;
      }
    }
    
    // Check if data loaded
    if (typeof experiments === 'undefined' || typeof scoreMatrix === 'undefined') {
      console.error('Failed to load bias data - check if /js/bias-data.js is accessible');
      // Fallback to show static content without animation
      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('result-score').textContent = '7.5';
        document.getElementById('model-name').textContent = 'ChutGPT-4.1-nano';
        document.getElementById('prompt-name').textContent = 'Sample Name';
      });
    } else {
      // Data loaded successfully, proceed with normal operation
    
    function updateHeatmap(name, model, score) {
      if (scoreMatrix[name] && score !== "â€”") {
        scoreMatrix[name][model] = parseFloat(score);
        
        // Update table cells - map names to DOM IDs
        let nameKey;
        if (name === "Chad Andersen") nameKey = "chad";
        else if (name === "Lisa Andersen") nameKey = "lisa";
        else if (name === "Tyrone Jefferson") nameKey = "tyrone";
        else if (name === "Latonya Jefferson") nameKey = "latonya";
        else if (name === "Mohammad Hussein") nameKey = "mohammad";
        else if (name === "Fatima Hussein") nameKey = "fatima";
        else if (name === "JosÃ© HernÃ¡ndez") nameKey = "jose";
        else if (name === "Maria HernÃ¡ndez") nameKey = "maria";
        else if (name === "Qingmei Chen") nameKey = "qingmei";
        else if (name === "Feng Chen") nameKey = "feng";
        else if (name === "Samir Singh") nameKey = "samir";
        else if (name === "Priyanka Singh") nameKey = "priyanka";
        
        if (nameKey) {
          const chutgptScore = scoreMatrix[name]["ChutGPT-4.1-nano"];
          const camelScore = scoreMatrix[name]["Camel-3.1-405B"];
          const deepfindScore = scoreMatrix[name]["Deepfind-R1"];
          
          if (chutgptScore !== null) {
            const cell = document.getElementById(`${nameKey}-chutgpt`);
            cell.textContent = chutgptScore.toFixed(1);
            cell.style.backgroundColor = getScoreColor(chutgptScore);
          }
          
          if (camelScore !== null) {
            const cell = document.getElementById(`${nameKey}-goat`);
            cell.textContent = camelScore.toFixed(1);
            cell.style.backgroundColor = getScoreColor(camelScore);
          }
          
          if (deepfindScore !== null) {
            const cell = document.getElementById(`${nameKey}-deepfind`);
            cell.textContent = deepfindScore.toFixed(1);
            cell.style.backgroundColor = getScoreColor(deepfindScore);
          }
        }
      }
    }
    
    function getScoreColor(score) {
      if (score >= 8.5) return "#dcfce7"; // green-100
      if (score >= 7.5) return "#fef3c7"; // yellow-100
      if (score >= 6.5) return "#fed7aa"; // orange-100
      return "#fecaca"; // red-100
    }
    
    function clearHeatmap() {
      // Clear all heatmap cells
      const names = ["chad", "lisa", "tyrone", "latonya", "mohammad", "fatima", "jose", "maria", "qingmei", "feng", "samir", "priyanka"];
      const models = ["chutgpt", "goat", "deepfind"];
      
      names.forEach(name => {
        models.forEach(model => {
          const cell = document.getElementById(`${name}-${model}`);
          if (cell) {
            cell.textContent = "â€”";
            cell.style.backgroundColor = "";
          }
        });
      });
      
      // Reset scoreMatrix
      Object.keys(scoreMatrix).forEach(name => {
        scoreMatrix[name] = {
          "ChutGPT-4.1-nano": null,
          "Camel-3.1-405B": null,
          "Deepfind-R1": null
        };
      });
    }
    
    function updateExperiment() {
      const exp = experiments[currentIndex];
      
      // Update model and score
      document.getElementById('model-name').textContent = exp.model;
      document.getElementById('result-score').textContent = exp.score;
      
      // Also rotate the black box status
      rotateBlackBoxStatus();
      
      // Animate variable substitution
      if (exp.template) {
        document.getElementById('prompt-name').textContent = exp.name;
        document.getElementById('prompt-name').className = "bg-blue-400 text-white px-1 rounded font-bold animate-pulse";
      } else {
        // Update name immediately
        document.getElementById('prompt-name').textContent = exp.name;
        // Flash yellow for substitution effect
        document.getElementById('prompt-name').className = "bg-yellow-300 text-black px-1 rounded font-bold border border-yellow-500 animate-pulse";
        
        setTimeout(() => {
          document.getElementById('prompt-name').className = "bg-yellow-300 text-black px-1 rounded font-bold border border-yellow-500";
        }, 300);
        
        // Update heatmap for the current name
        updateHeatmap(exp.name, exp.model, exp.score);
      }
      
      // Move to next experiment
      currentIndex = (currentIndex + 1) % experiments.length;
      
      // Check if we've completed the full cycle (we're back at the start)
      if (currentIndex === 0) {
        // Clear heatmap after a delay to show the last result
        setTimeout(clearHeatmap, 1500);
      }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      setInterval(updateExperiment, 2000);
    });
    
    } // End of else block for successful data loading
  </script>

  <!-- Three Columns -->
  <div class="max-w-6xl mx-auto px-6 py-8">
    <div class="grid md:grid-cols-3 gap-12">
      
      <!-- Work Locally -->
      <div>
        <h3 class="text-2xl font-light text-gray-800 mb-4">Work Locally</h3>
        <p class="text-gray-600 mb-6 leading-relaxed">
          Run Auditomatic locally for complete data privacy. Your prompts, results, and API keys stay on your machine. 
          Works on macOS, Windows, and Linux.
        </p>
        <a href="/download" class="bg-red-800 text-white px-4 py-2 rounded text-sm hover:bg-red-900">Install now Â»</a>
      </div>

      <!-- Design & Test -->
      <div>
        <h3 class="text-2xl font-light text-gray-800 mb-4">Design & Test</h3>
        <p class="text-gray-600 mb-6 leading-relaxed">
          Create prompt templates with variables like {name} or {topic}. Test systematically across 
          OpenAI, Anthropic, and other providers. Compare responses and identify patterns in model behavior.
        </p>
        <a href="/guides/getting-started" class="bg-red-800 text-white px-4 py-2 rounded text-sm hover:bg-red-900">Get started Â»</a>
      </div>

      <!-- Export Results -->
      <div>
        <h3 class="text-2xl font-light text-gray-800 mb-4">Export Results</h3>
        <p class="text-gray-600 mb-6 leading-relaxed">
          Export results as CSV or JSON files. Create pivot tables to analyze patterns by model, variable, or custom dimensions. 
          Archive complete experiments for reproducible research.
        </p>
        <a href="/guides/results-analysis" class="bg-red-800 text-white px-4 py-2 rounded text-sm hover:bg-red-900">View details Â»</a>
      </div>

    </div>
  </div>

  <!-- Footer -->
  <div class="border-t border-gray-200 py-8 text-center text-sm text-gray-500">
    <div class="max-w-4xl mx-auto px-6">
      <p>
        Found a bug? <a href="https://github.com/auditomatic/lite-app/issues" class="text-blue-600">Tell us on GitHub</a>
      </p>
    </div>
  </div>
</div>
{{ end }}